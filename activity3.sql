CREATE TABLE IF NOT EXISTS CUSTOMER(
    CUSTOMER_ID TEXT PRIMARY KEY,
    CUSTOMER_NAME TEXT,
    CUSTOMER_CITY TEXT,
    GRADE TEXT,
    SALESMAN_ID TEXT,
);

INSERT INTO CUSTOMER(CUSTOMER_ID,CUSTOMER_NAME,CUSTOMER_CITY,GRADE,SALESMAN_ID)VALUES
('1','A','MUMBAI','100','10'),
('2','B','MUMBAI','350','20'),
('3','C','DELHI','250','30'),
('4','D','BHOPAL','201','40');

CREATE TABLE IF NOT EXISTS SALESMAN(
    SALESMAN_ID TEXT PRIMARY KEY,
    NAME TEXT,
    CITY TEXT,
    COMMISION TEXT,
    FOREIGN KEY (SALESMAN_ID) REFERENCES SALESMAN(SALESMAN_ID)
);
INSERT INTO SALESMAN(SALESMAN_ID,NAME,CITY,COMMISSION)VALUES
('10','PATEL','MUMBAI','0.12'),
('20','RAHUL','MUMBAI','0.14'),
('30','VIRAJ','DELHI','0.13'),
('40','ROHIT','BHOPAL','0.12');

CREATE TABLE IF NOT EXISTS ORDER(
    ord_no TEXT
    ord_amt TEXT,
    ord_date TEXT,
    SALESMAN_ID TEXT,
    CUSTOMER_ID text,
    FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER(CUSTOMER_ID),
    FOREIGN KEY (SALESMAN_ID) REFERENCES SALESMAN(SALESMAN_ID),
);
INSERT INTO ORDER(ord_no,ord_amt,ord_date,SALESMAN_ID,CUSTOMER_ID)VALUES
('100','325','12-10-24','10','1'),
('101','250','11-10-24','20','2'),
('102','475','12-10-24','30','3'),
('103','300','11-10-24','40','4');
SELECT CUSTOMER.CUSTOMER_NAME,SALESMAN.NAME,SALESMAN.CITY
FROM CUSTOMER
JOIN SALESMAN ON CUSTOMER.CITY =SALESMAN.CITY;

SELECT CUSTOMER.CUSTOMER_NAME,SALESMAN.NAME
FROM CUSTOMER
JOIN SALESMAN ON CUSTOMER.SALESMAN_ID = SALESMAN=SALESMAN_ID;

SELECT ORDER.ord_no, CUSTOMER.CUSTOMER_NAME, ORDER.CUSTOMER_ID, ORDER.SALESMAN_ID
FROM ORDER
JOIN CUSTOMER ON ORDER.CUSTOMER_ID = CUSTOMER.CUSTOMER_ID
JOIN SALESMAN ON ORDER.SALESMAN_ID = SALESMAN.SALESMAN_ID
WHERE CUSTOMER.CUSTOMER_CITY <> SALESMAN.CITY;

SELECT ORDER.ord_no, CUSTOMER.CUSTOMER_NAME
FROM ORDER
JOIN CUSTOMER ON ORDER.CUSTOMER_ID = CUSTOMER=CUSTOMER_ID;

SELECT CUSTOMER.CUSTOMER_NAME AS "Customer", CUSTOMER.GRADE AS "Grade"
FROM ORDER
JOIN SALESMAN ON ORDER.SALESMAN_ID = SALESMAN.SALESMAN_ID
JOIN CUSTOMER ON ORDER.CUSTOMER_ID = CUSTOMER.CUSTOMER_ID
WHERE CUSTOMER.GRADE IS NOT NULL;

SELECT CUSTOMER.CUSTOMER_NAME AS "Customer",
CUSTOMER.CUSTOMER_CITY AS "City",
SALESMAN.NAME AS "Salesman",
SALESMAN.COMMISION
FROM CUSTOMER
JOIN SALESMAN ON CUSTOMER.SALESMAN_ID = SALESMAN.SALESMAN_ID
WHERE SALESMAN.COMMISION BETWEEN 0.12 AND 0.14;

SELECT ORDER.ord_no, Customer.CUSTOMER_NAME, SALESMAN.COMMISION AS "Commission%",
ORDER.ord_amt * SALESMAN.COMMISION AS "Commission"
FROM ORDER
JOIN SALESMAN ON ORDER.SALESMAN_ID = SALESMAN.SALESMAN_ID
JOIN CUSTOMER ON ORDER.CUSTOMER_ID = CUSTOMER.CUSTOMER_ID
WHERE CUSTOEMR.GRADE >= 200;

SELECT *
FROM CUSTOMER
JOIN ORDER ON CUSTOMER.CUSTOMER_ID = ORDER.CUSTOMER_ID
WHERE ORDER.ord_date = '2012-10-05';

